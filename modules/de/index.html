
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://Yichen-Si.github.io/punkst/modules/de/">
      
      
        <link rel="prev" href="../pixel-decode/">
      
      
        <link rel="next" href="../visualization/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>DE tests - punkst</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#differential-expression-tests" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="punkst" class="md-header__button md-logo" aria-label="punkst" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            punkst
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              DE tests
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Yichen-Si/punkst" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Yichen-Si/punkst
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  
    
  
  Intro

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../workflows/" class="md-tabs__link">
          
  
  
    
  
  Quickstart

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  Modules

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../input/" class="md-tabs__link">
        
  
  
    
  
  Input

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="punkst" class="md-nav__button md-logo" aria-label="punkst" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    punkst
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Yichen-Si/punkst" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    Yichen-Si/punkst
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../.." class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Intro
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Intro
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Install
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../workflows/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Quickstart
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Quickstart
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workflows/multisample/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multisample
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Modules
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Modules
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pts2tiles/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    pts2tiles
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tiles2hex/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    tiles2hex
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lda4hex/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    topic-model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pixel-decode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    pixel-decode
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    DE tests
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    DE tests
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#de-chisq" class="md-nav__link">
    <span class="md-ellipsis">
      
        de-chisq
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="de-chisq">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input-format" class="md-nav__link">
    <span class="md-ellipsis">
      
        Input Format
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#required-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Required Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optional-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Optional Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output" class="md-nav__link">
    <span class="md-ellipsis">
      
        Output
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-conditional-de-pixel" class="md-nav__link">
    <span class="md-ellipsis">
      
        multi-conditional-de-pixel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="multi-conditional-de-pixel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#required-parameters_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Required Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optional-parameters_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Optional Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-files" class="md-nav__link">
    <span class="md-ellipsis">
      
        Output Files
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-conditional-de-pois" class="md-nav__link">
    <span class="md-ellipsis">
      
        multi-conditional-de-pois
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="multi-conditional-de-pois">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#required-parameters_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Required Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optional-parameters_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Optional Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-files_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Output Files
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../visualization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    visualize
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../coexp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    co-occurrence
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tileop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    tile-op
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../input/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Input
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#de-chisq" class="md-nav__link">
    <span class="md-ellipsis">
      
        de-chisq
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="de-chisq">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#input-format" class="md-nav__link">
    <span class="md-ellipsis">
      
        Input Format
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#required-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Required Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optional-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Optional Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output" class="md-nav__link">
    <span class="md-ellipsis">
      
        Output
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-conditional-de-pixel" class="md-nav__link">
    <span class="md-ellipsis">
      
        multi-conditional-de-pixel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="multi-conditional-de-pixel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#required-parameters_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Required Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optional-parameters_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Optional Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-files" class="md-nav__link">
    <span class="md-ellipsis">
      
        Output Files
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-conditional-de-pois" class="md-nav__link">
    <span class="md-ellipsis">
      
        multi-conditional-de-pois
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="multi-conditional-de-pois">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#required-parameters_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Required Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optional-parameters_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Optional Parameters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-files_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Output Files
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="differential-expression-tests">Differential expression tests<a class="headerlink" href="#differential-expression-tests" title="Permanent link">&para;</a></h1>
<ul>
<li><code>punkst multi-conditional-de-pixel</code>: Multi-sample (pairwise), cell type-specific DE using pixel-level annotations.</li>
<li><code>punkst multi-conditional-de-pois</code>: Multi-sample (pairwise), cell type-specific DE using Poisson regression on spot-level data.</li>
<li><code>punkst de-chisq</code>: Chi-squared DE on pseudobulk matrices.</li>
</ul>
<h2 id="de-chisq">de-chisq<a class="headerlink" href="#de-chisq" title="Permanent link">&para;</a></h2>
<p><code>de-chisq</code> runs <span class="arithmatex">\(\chi^2\)</span> tests on a pseudobulk matrix for a quick and dirty check on gene enrichment at factor level.
Provide one input for a 1-vs-rest test per factor, or two inputs for a pairwise comparison of each factor between datasets.</p>
<ul>
<li>
<p>1-vs-rest per factor:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>punkst<span class="w"> </span>de-chisq<span class="w"> </span>--input<span class="w"> </span>pseudobulk.tsv<span class="w"> </span>--out<span class="w"> </span>de.tsv<span class="w"> </span>--min-fc<span class="w"> </span><span class="m">1</span>.5<span class="w"> </span>--max-pval<span class="w"> </span>1e-3
</span></code></pre></div>
By default, it also reports 1-vs-neighbors results that highlight more specific genes enriched in this factor compared to <code>k</code> (default 3) other most similar factors.</p>
</li>
<li>
<p>Pairwise comparison between two pseudobulk matrices:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>punkst<span class="w"> </span>de-chisq<span class="w"> </span>--input<span class="w"> </span>sampleA.pseudobulk.tsv<span class="w"> </span>sampleB.pseudobulk.tsv<span class="w"> </span><span class="se">\</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">  </span>--out<span class="w"> </span>de.pair.tsv<span class="w"> </span>--min-fc<span class="w"> </span><span class="m">1</span>.5<span class="w"> </span>--max-pval<span class="w"> </span>1e-4
</span></code></pre></div></p>
</li>
</ul>
<h3 id="input-format">Input Format<a class="headerlink" href="#input-format" title="Permanent link">&para;</a></h3>
<p>The input is a TSV file where the first row must be a header including an arbitrary label for the feature name column (e.g. "Gene") followed by K factor / cell type names.
Then each row starts with the gene name followed by counts of that gene for each factor.</p>
<p>Such matrices will be generated by <code>punkst topic-model</code> and <code>pixel-decode</code>.</p>
<p>For pairwise input, the two matrices should have matching factor columns. Feature names are intersected between the two files.</p>
<h3 id="required-parameters">Required Parameters<a class="headerlink" href="#required-parameters" title="Permanent link">&para;</a></h3>
<p><code>--input</code> - Input TSV file. Provide one file for 1-vs-rest tests, or two files for pairwise comparison.
<code>--out</code> - Output TSV file.</p>
<h3 id="optional-parameters">Optional Parameters<a class="headerlink" href="#optional-parameters" title="Permanent link">&para;</a></h3>
<p><code>--min-count-per-feature</code> - Minimum total count for a feature to be considered. Default: 100.</p>
<p><code>--max-pval</code> - Max p-value for output. Default: 1e-3.</p>
<p><code>--min-fc</code> - Minimum fold change. Default: 1.5.</p>
<p><code>--min-count</code> - Minimum observed count for a (feature, factor) pair to be tested. Default: 10.</p>
<p><code>--pseudocount</code> - Pseudocount added to each cell for the Chi-squared test. Default: 0.5.</p>
<p><code>--threads</code> - Number of threads. Default: 1. (normally unnecessary)</p>
<p><code>--neighbor-k</code> - Number of nearest neighbor columns to aggregate as background (single input only). Default: 3. Must be smaller than K-1. When set, writes an additional output file with 1-vs-neighbors results.</p>
<p><code>--confusion</code> - (Pairwise mode only; experimental heuristics) Two confusion matrices to deconvolve the two input pseudobulk matrices before comparison, meant to reduce the bias due to the difference of spatial environment or contaminations (from neighboring factors) between datasets.</p>
<h3 id="output">Output<a class="headerlink" href="#output" title="Permanent link">&para;</a></h3>
<p>Single input output columns:</p>
<p><code>Feature</code>, <code>Factor</code>, <code>Chi2</code>, <code>FoldChange</code>, <code>log10pval</code></p>
<p>When <code>--neighbor-k &gt; 0</code>, an additional file is written with the same columns and the suffix <code>.1vsNeighbors.tsv</code> (if <code>--out</code> ends with <code>.tsv</code>, that extension is stripped first).</p>
<p>Two-input output columns:</p>
<p><code>Feature</code>, <code>Factor</code>, <code>Chi2</code>, <code>FoldChange</code>, <code>log10pval</code>, <code>Count1</code>, <code>Count2</code></p>
<p>Rows are sorted by factor (ascending) and Chi2 (descending) within each factor.</p>
<h2 id="multi-conditional-de-pixel">multi-conditional-de-pixel<a class="headerlink" href="#multi-conditional-de-pixel" title="Permanent link">&para;</a></h2>
<p><code>multi-conditional-de-pixel</code> joins pixel-level annotation results with the original transcript data on the fly and performs cell-type-specific DE between dataset groups. It aggregates transcripts into grid units of size <code>--grid-size</code> stratified by pixel level cell type assignments then runs pairwise tests for each cell type using a Binomial model. By default it builds all pairwise contrasts from <code>--labels</code> (or numeric indices); for more general comparisons, use a contrast design file.
The p-values are computed both by permutation and by robust sandwich estimators of the standard errors of the estimated effect sizes.</p>
<p><span class="arithmatex">\(X^{(k)}_{im} \sim\)</span> Binom <span class="arithmatex">\((N^{(k)}_{im}, \pi^{(k)}_{im})\)</span> for cell type <span class="arithmatex">\(k\)</span>, bin <span class="arithmatex">\(i\)</span> and gene <span class="arithmatex">\(m\)</span>, where both <span class="arithmatex">\(X\)</span> and <span class="arithmatex">\(N\)</span> are soft-aggregated counts from pixel level cell type assignments.</p>
<p>logit <span class="arithmatex">\((\pi^{(k)}_{im}) = a^{(k)}_m + y_i b^{(k)}_m\)</span>, where <span class="arithmatex">\(y_i\)</span> is a binary indicator for the dataset (0/1). The null hypothesis is <span class="arithmatex">\(b^{(k)}_m = 0\)</span>.</p>
<p>Note: the intended use is when the cell type model is from external sources (e.g. apply <code>pixel-decode</code> with a reference-based cell type pseudobulk matrix). The interpretation is tricky if the cell types are learned from the same datasets. Either way, this is only a data exploration tool and we do not claim that it is statistically rigorous.</p>
<p>Example usage (pairwise contrasts between input datasets):
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>punkst<span class="w"> </span>multi-conditional-de-pixel<span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="w">  </span>--anno<span class="w"> </span>sampleA/pixel<span class="w"> </span>sampleB/pixel<span class="w"> </span>--binary<span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="w">  </span>--pts<span class="w"> </span>sampleA/transcripts.tiled<span class="w"> </span>sampleB/transcripts.tiled<span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">  </span>--labels<span class="w"> </span>sampleA<span class="w"> </span>sampleB<span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="w">  </span>--K<span class="w"> </span><span class="m">12</span><span class="w"> </span>--features<span class="w"> </span>features.tsv<span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="w">  </span>--grid-size<span class="w"> </span><span class="m">20</span><span class="w"> </span>--min-count<span class="w"> </span><span class="m">10</span><span class="w"> </span>--perm<span class="w"> </span><span class="m">5000</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="w">  </span>--icol-x<span class="w"> </span><span class="m">0</span><span class="w"> </span>--icol-y<span class="w"> </span><span class="m">1</span><span class="w"> </span>--icol-feature<span class="w"> </span><span class="m">2</span><span class="w"> </span>--icol-val<span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="w">  </span>--out<span class="w"> </span>de/pixel_de<span class="w"> </span>--threads<span class="w"> </span><span class="m">8</span><span class="w"> </span>--seed<span class="w"> </span><span class="m">1</span>
</span></code></pre></div></p>
<p>Example usage with explicit contrast file:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>punkst<span class="w"> </span>multi-conditional-de-pixel<span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">  </span>--contrast<span class="w"> </span>contrast.tsv<span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">  </span>--K<span class="w"> </span><span class="m">12</span><span class="w"> </span>--features<span class="w"> </span>features.tsv<span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">  </span>--grid-size<span class="w"> </span><span class="m">20</span><span class="w"> </span>--min-count<span class="w"> </span><span class="m">10</span><span class="w"> </span>--perm<span class="w"> </span><span class="m">5000</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">  </span>--icol-x<span class="w"> </span><span class="m">0</span><span class="w"> </span>--icol-y<span class="w"> </span><span class="m">1</span><span class="w"> </span>--icol-feature<span class="w"> </span><span class="m">2</span><span class="w"> </span>--icol-val<span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">  </span>--out<span class="w"> </span>de/pixel_de<span class="w"> </span>--threads<span class="w"> </span><span class="m">8</span><span class="w"> </span>--seed<span class="w"> </span><span class="m">1</span>
</span></code></pre></div></p>
<p><code>contrast.tsv</code> format (tab-delimited):
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>anno_prefix pts_prefix  B_vs_A  C_vs_A
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>sampleA/pixel   sampleA/transcripts.tiled   -1  -1
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>sampleB/pixel   sampleB/transcripts.tiled   1   0
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>sampleC/pixel   sampleC/transcripts.tiled   0   1
</span></code></pre></div>
Each contrast column uses <code>-1</code> (group 0), <code>1</code> (group 1), or <code>0</code> (exclude). Contrast names come from the header.</p>
<h3 id="required-parameters_1">Required Parameters<a class="headerlink" href="#required-parameters_1" title="Permanent link">&para;</a></h3>
<p>Provide either <code>--anno</code>, <code>--pts</code> (or <code>--anno-data</code>/<code>--anno-index</code>, <code>--pts</code>) or a <code>--contrast</code> design file.</p>
<p><code>--anno</code> - Prefixes of pixel annotation files (from <code>punkst pixel-decode</code>). For each prefix, the tool expects <code>&lt;prefix&gt;.tsv</code> (or <code>&lt;prefix&gt;.bin</code> if <code>--binary</code>) and <code>&lt;prefix&gt;.index</code>. Cannot be combined with <code>--contrast</code>.</p>
<p><code>--anno-data</code>, <code>--anno-index</code> - Alternative to <code>--anno</code>. Provide explicit data and index files (same count for each).</p>
<p><code>--pts</code> - Prefixes of transcript data files (from <code>punkst pts2tiles</code>). For each prefix, the tool expects <code>&lt;prefix&gt;.tsv</code> and <code>&lt;prefix&gt;.index</code>. Cannot be combined with <code>--contrast</code>.</p>
<p><code>--contrast</code> - Contrast design TSV with columns: <code>anno_prefix</code>, <code>pts_prefix</code>, and one or more contrast columns (values -1/0/1). When provided, it replaces <code>--anno/--anno-data/--anno-index/--pts</code> and <code>--labels</code>.</p>
<p><code>--K</code> - Number of factors in the annotation files.</p>
<p><code>--features</code> - A list of features to test, one feature name per line (lines starting with <code>#</code> are ignored).</p>
<p><code>--grid-size</code> - Grid size used to aggregate transcripts into units.</p>
<p><code>--icol-x</code>, <code>--icol-y</code>, <code>--icol-feature</code>, <code>--icol-val</code> - Column indices for X/Y coordinates, feature name, and count in the transcript files (0-based).</p>
<p><code>--out</code> - Output prefix.</p>
<p>Annotation and transcript tiles must use the same tile size for each dataset pair (this is guaranteed if the pixel level decoding results are generated from the corresponding transcript tiles by <code>punkst pixel-decode</code>).</p>
<h3 id="optional-parameters_1">Optional Parameters<a class="headerlink" href="#optional-parameters_1" title="Permanent link">&para;</a></h3>
<p><code>--labels</code> - Labels for datasets used in pairwise output; defaults to <code>0..N-1</code>. Ignored when <code>--contrast</code> is supplied.</p>
<p><code>--binary</code> - Indicates the annotation data files are binary (<code>.bin</code>).</p>
<p><code>--min-count-per-feature</code> - Minimum total count (in each pairwise comparison) for a feature to be considered. Default: 100.</p>
<p><code>--max-pval</code> - Max p-value for output. Default: 1 (output all).</p>
<p><code>--max-pval-deconv</code> - If at least two cell types (slices) have a p-value less than this threshold, the tool runs a deconvolution to estimate effects adjusted for other cell types. Default: 1e-3.</p>
<p><code>--min-or</code> - Minimum odds ratio for output (bidirectional, so OR<span class="arithmatex">\(&gt;x\)</span> and OR<span class="arithmatex">\(&lt;1/x\)</span> are kept). Default: 1 (output all).</p>
<p><code>--min-count</code> - Minimum observed cell-type-specific count for a unit to be included. Default: 10.</p>
<p><code>--perm</code> - Number of permutations for beta calibration (two-group contrasts). Default: 0 (model-based p-values only).</p>
<p><code>--min-or-perm</code> - Minimum odds ratio for permutation testing (bidirectional). Default: 1.2.</p>
<p><code>--seed</code> - Random seed for permutation.</p>
<p><code>--threads</code> - Number of threads. Default: 1. Almost the entire runtime is spent in data loading, so multi-threading is very useful for large datasets since tiles of data are loaded simultaneously.</p>
<p><code>--debug</code> - Enable debug logging.</p>
<h3 id="output-files">Output Files<a class="headerlink" href="#output-files" title="Permanent link">&para;</a></h3>
<p>Given <code>--out PREFIX</code>, the tool generates one main output file per contrast, plus auxiliary files.</p>
<ul>
<li>When permutation is enabled (<code>--perm &gt; 0</code>), for each contrast:</li>
<li>
<p><code>PREFIX.CONTRAST.perm_N.tsv</code> is generated, where <code>CONTRAST</code> is from the <code>--contrast</code> file header or <code>labelA_vs_labelB</code> for auto-pairwise, and <code>N</code> is the number of permutations. It contains permutation-based p-values for significant associations. Columns are: <code>Slice</code>, <code>Feature</code>, <code>Beta</code>, <code>Pi0</code>, <code>Pi1</code>, <code>TotalCount</code>, <code>log10p</code>, <code>p_perm</code>.</p>
</li>
<li>
<p>When permutation is not enabled (<code>--perm 0</code>), for each contrast:</p>
</li>
<li><code>PREFIX.CONTRAST.tsv</code> is generated.</li>
<li>
<p><strong>Columns</strong>:</p>
<ul>
<li><code>Slice</code>: Cell type index (0-based).</li>
<li><code>Feature</code>: Feature name.</li>
<li><code>Beta</code>: Marginal log odds ratio for the feature.</li>
<li><code>log10p</code>: -log10(p-value) for <code>Beta</code>.</li>
<li><code>Pi0</code>, <code>Pi1</code>: Estimated feature prevalence in group 0 and 1.</li>
<li><code>TotalCount</code>: Total feature count in this cell type and contrast.</li>
<li><code>Beta_global</code>: Weighted average of <code>Beta</code> across cell types.</li>
<li><code>log10p_global</code>: -log10(p-value) for <code>Beta_global</code>.</li>
<li><code>log10p_deviation</code>: -log10(p-value) for the deviation of <code>Beta</code> from <code>Beta_global</code>.</li>
<li><code>Beta_deconv</code>: Deconvolved <code>Beta</code>, adjusted for other cell types. This is experimental and computed only when deconvolution is triggered (see <code>--max-pval-deconv</code>).</li>
<li><code>log10p_deconv</code>: -log10(p-value) for <code>Beta_deconv</code>.</li>
</ul>
</li>
<li>
<p>Auxiliary files:</p>
</li>
<li><code>PREFIX.nobs.tsv</code>: The number of units and total pixel counts per cell type and dataset.</li>
<li><code>PREFIX.sums.tsv</code>: Total feature counts per cell type and dataset for units passing filters.</li>
</ul>
<h2 id="multi-conditional-de-pois">multi-conditional-de-pois<a class="headerlink" href="#multi-conditional-de-pois" title="Permanent link">&para;</a></h2>
<p><code>multi-conditional-de-pois</code> performs cell-type-specific differential expression on pre-defined spatial units (e.g. hexagons from <code>tiles2hex</code>, other binned data, single cells, or low resolution data like Visium). It leverages a pre-trained topic model (e.g., LDA from <code>punkst topic-model</code>) to estimate cell type mixture proportions within each unit first, then for each gene and cell type, it fits a Poisson regression model to estimate differential expression between specified groups of datasets.</p>
<p>For gene <span class="arithmatex">\(m\)</span> and unit <span class="arithmatex">\(i\)</span>, the model is: <span class="arithmatex">\(Y_{im} \sim \text{Pois}(\lambda_{im})\)</span> with rate <span class="arithmatex">\(\lambda_{im}\)</span> defined by a mixture across cell types:
<span class="arithmatex">\(\lambda_{im} = \sum_k \theta_{ik} g^{-1}( \eta_{mk}^0 + x_i b_{mk} )\)</span>
where <span class="arithmatex">\(\theta_{ik}\)</span> is the proportion of cell type <span class="arithmatex">\(k\)</span> in unit <span class="arithmatex">\(i\)</span>, <span class="arithmatex">\(x_i \in \set{\pm 1}\)</span> indicates the group that unit <span class="arithmatex">\(i\)</span> belongs to. The null hypothesis is <span class="arithmatex">\(b_{mk}=0\)</span>, and <span class="arithmatex">\(g\)</span> is a link function. The <code>log1p</code> link <span class="arithmatex">\(g^{-1}(\eta)=c_i (\exp(\eta) - 1) \ (c_i=n_i/L)\)</span> is much more efficient than the canonical <code>log</code> link with similar performance in practice.</p>
<p>Example usage with explicit contrast file:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>punkst<span class="w"> </span>multi-conditional-de-pois<span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">  </span>--contrast<span class="w"> </span>contrast.tsv<span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">  </span>--model<span class="w"> </span>my_lda_model.bin<span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">  </span>--link<span class="w"> </span>log1p<span class="w"> </span><span class="se">\</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">  </span>--out<span class="w"> </span>de/unit_de<span class="w"> </span>--threads<span class="w"> </span><span class="m">8</span>
</span></code></pre></div></p>
<p><code>contrast.tsv</code> format (tab-delimited):
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>in-data in-meta B_vs_A
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>sampleA/hex.tsv sampleA/hex.json    -1
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>sampleB/hex.tsv sampleB/hex.json    1
</span></code></pre></div>
Each contrast column uses <code>-1</code> (group 0), <code>1</code> (group 1), or <code>0</code> (exclude). Contrast names come from the header. The <code>in-data</code> column points to unit-level count data (e.g. from <code>tiles2hex</code>) and <code>in-meta</code> points to the corresponding metadata file.</p>
<h3 id="required-parameters_2">Required Parameters<a class="headerlink" href="#required-parameters_2" title="Permanent link">&para;</a></h3>
<p>Provide either <code>--in-data</code> and <code>--in-meta</code> (for automatic pairwise contrasts) or a <code>--contrast</code> design file.</p>
<p><code>--model</code> - Path to the trained topic model file (e.g. LDA from <code>topic-model</code>).</p>
<p><code>--out</code> - Output prefix.</p>
<p><code>--contrast</code> - Contrast design TSV with columns: <code>in-data</code>, <code>in-meta</code>, and one or more contrast columns (values -1/0/1). When provided, it replaces <code>--in-data</code>, <code>--in-meta</code> and <code>--labels</code>.</p>
<h3 id="optional-parameters_2">Optional Parameters<a class="headerlink" href="#optional-parameters_2" title="Permanent link">&para;</a></h3>
<p><code>--in-data</code> - Input data files (<code>.tsv</code> from <code>tiles2hex</code>).</p>
<p><code>--in-meta</code> - Metadata files (<code>.json</code> from <code>tiles2hex</code>).</p>
<p><code>--labels</code> - Labels for datasets used in pairwise output; defaults to <code>0..N-1</code>. Ignored when <code>--contrast</code> is supplied.</p>
<p><code>--link</code> - Regression link function: <code>log</code> or <code>log1p</code>. Default: <code>log1p</code>.</p>
<p><code>--min-count</code> - Minimum total count per unit to be included. Default: 50.</p>
<p><code>--min-count-per-feature</code> - Minimum total count for a feature to be tested. Default: 100.</p>
<p><code>--min-units-per-feature</code> - Minimum number of units with a non-zero count for a feature to be tested. Default: <code>K * 10</code> where <code>K</code> is number of cell types.</p>
<p><code>--max-pval</code> - Max p-value for output. Default: 1.</p>
<p><code>--se-method</code> - Method for calculating standard errors. 1: Fisher (model-based), 2: Sandwich (robust), 3: both. Default: 1.</p>
<p><code>--size-factor</code> - Size factor <span class="arithmatex">\(L\)</span> for the Poisson regression model. Default: 10000.0.</p>
<p><code>--threads</code> - Number of threads. Default: 1.</p>
<h3 id="output-files_1">Output Files<a class="headerlink" href="#output-files_1" title="Permanent link">&para;</a></h3>
<p>Given <code>--out PREFIX</code>, the tool generates one main output file per contrast, plus an auxiliary file.</p>
<ul>
<li>For each contrast, <code>PREFIX.CONTRAST.tsv</code> is generated, where <code>CONTRAST</code> is from the <code>--contrast</code> file header or <code>labelA_vs_labelB</code> for auto-pairwise.</li>
<li>
<p><strong>Columns</strong>:</p>
<ul>
<li><code>Feature</code>: Feature name.</li>
<li><code>Factor</code>: Cell type name.</li>
<li><code>Beta</code>: log fold change for the feature in this cell type.</li>
<li><code>SE</code>: Standard error of Beta. If <code>se-method=3</code>, an additional <code>SE0</code> column with the Fisher-based SE is included.</li>
<li><code>log10p</code>: -log10(p-value) for <code>Beta</code>.</li>
<li><code>Dist2bd</code>: Distance of the beta estimate to the optimization boundary. Small values may indicate unstable estimates.</li>
<li><code>n</code>: Number of units included in the test for this feature.</li>
<li><code>Count1</code>, <code>Count2</code>: Total counts of the feature in group 1 and group 2.</li>
</ul>
</li>
<li>
<p>An auxiliary file <code>PREFIX.CONTRAST.eta0.tsv</code> is also generated, containing the fitted baseline (log) expression rates for each gene and cell type.</p>
</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../pixel-decode/" class="md-footer__link md-footer__link--prev" aria-label="Previous: pixel-decode">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                pixel-decode
              </div>
            </div>
          </a>
        
        
          
          <a href="../visualization/" class="md-footer__link md-footer__link--next" aria-label="Next: visualize">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                visualize
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["content.code.annotate", "content.code.copy", "content.tooltips", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>